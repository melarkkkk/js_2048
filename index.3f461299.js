var t={};class e{static get STATUS(){return{IDLE:"idle",PLAYING:"playing",WIN:"win",LOSE:"lose"}}constructor(t){this.state=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.status=e.STATUS.IDLE,this.score=0}moveLeft(){let t=[],e=!1;for(let s=0;s<4;s++){let a=this.state[s].filter(t=>0!==t);for(let t=0;t<a.length-1;t++)a[t]===a[t+1]&&(a[t]*=2,a[t+1]=0,this.score+=a[t],t++);let r=a.filter(t=>0!==t);for(;r.length<4;)r.push(0);this.state[s].every((t,e)=>t===r[e])||(e=!0),t.push(r)}return!!e&&(this.state=t,this.checkWin(),!0)}moveRight(){let t=[],e=!1;for(let s=0;s<4;s++){let a=this.state[s].filter(t=>0!==t);for(let t=a.length-1;t>0;t--)a[t]===a[t-1]&&(a[t]*=2,a[t-1]=0,this.score+=a[t],t--);let r=a.filter(t=>0!==t);for(;r.length<4;)r.unshift(0);this.state[s].every((t,e)=>t===r[e])||(e=!0),t.push(r)}return!!e&&(this.state=t,this.checkWin(),!0)}moveUp(){this.state=this.transpose(this.state);let t=this.moveLeft();return this.state=this.transpose(this.state),t}moveDown(){this.state=this.transpose(this.state);let t=this.moveRight();return this.state=this.transpose(this.state),t}getScore(){return this.score}getState(){return this.state}getStatus(){return this.status}start(){this.status=e.STATUS.PLAYING,this.addRandomTile(),this.addRandomTile()}restart(){this.status=e.STATUS.IDLE,this.score=0,this.state=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);if(!t.length){this.checkLose();return}let[e,s]=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.1>Math.random()?4:2}checkWin(){for(let t=0;t<4;t++)for(let s=0;s<4;s++)if(2048===this.state[t][s]){this.status=e.STATUS.WIN;return}}checkLose(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(0===this.state[t][e]||t<3&&this.state[t][e]===this.state[t+1][e]||e<3&&this.state[t][e]===this.state[t][e+1])return;this.status=e.STATUS.LOSE}transpose(t){return t[0].map((e,s)=>t.map(t=>t[s]))}}const s=new(t=e),a=document.querySelector(".game-score"),r=document.querySelector(".start"),i=document.querySelector(".message-start"),o=document.querySelector(".message-win"),h=document.querySelector(".message-lose"),n=Array.from(document.querySelectorAll(".field-cell"));function l(){let e=s.getState(),l=s.getStatus();n.forEach((t,s)=>{let a=e[Math.floor(s/4)][s%4];t.className="field-cell",t.textContent="",a&&(t.classList.add(`field-cell--${a}`),t.textContent=a)}),a.textContent=s.getScore(),l===t.STATUS.WIN?(o.classList.remove("hidden"),h.classList.add("hidden"),i.classList.add("hidden")):l===t.STATUS.LOSE?(h.classList.remove("hidden"),o.classList.add("hidden"),i.classList.add("hidden")):(l===t.STATUS.PLAYING?i.classList.add("hidden"):i.classList.remove("hidden"),o.classList.add("hidden"),h.classList.add("hidden")),l===t.STATUS.PLAYING?(r.textContent="Restart",r.classList.remove("start"),r.classList.add("restart")):(r.textContent="Start",r.classList.remove("restart"),r.classList.add("start"))}r.addEventListener("click",()=>{s.getStatus()===t.STATUS.IDLE||s.restart(),s.start(),l()}),document.addEventListener("keydown",function(e){if(s.getStatus()!==t.STATUS.PLAYING)return;let a=!1;switch(e.key){case"ArrowLeft":a=s.moveLeft();break;case"ArrowRight":a=s.moveRight();break;case"ArrowUp":a=s.moveUp();break;case"ArrowDown":a=s.moveDown()}a&&(s.addRandomTile(),s.checkLose(),l())}),l();
//# sourceMappingURL=index.3f461299.js.map
